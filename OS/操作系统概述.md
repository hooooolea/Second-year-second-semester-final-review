# OS
## 第一部分 操作系统概述

### 1.操作系统是什么？
操作系统是系统软件程序，是个**软件**！

**对计算机资源进行管理**。计算机资源简单来说，就是计算机的软件和硬件。

（不简单来说，计算机资源就是计算机系统中可以被用户或程序使用、分配和管理的各种硬件和软件要素。它们是计算机完成各种任务的基础）

---
### 2.操作系统的"特征"有哪些？

并发、共享、异步、虚拟（其中并发和共享是基本）
**！因为是特征所以是所有操作系统都有的**

### （1）并发：两个或多个活动在 *同一时间段* 中进行。

**举一个例子**：一定要知道一个单核cpu每一个时刻（瞬间）只能处理一个任务，但是在一个时间段内就可以看作很多个瞬间，cpu处理了多个任务，而这些任务就是在这个时间段内同时进行的。

### （2）共享：计算机系统的资源被多个进程所共用。

（操作系统通过合理的管理和调度，使得多个进程能够“共享”这些有限的资源，而不会互相干扰或发生冲突）

共享可以是同时（如多进程并发访问内存），也可以是轮流（如多个进程轮流使用打印机）


补充知识点（后面详细复习）：
  
**进程**是操作系统中正在运行的程序的实例，例如：你打开了微信和浏览器，这两个程序在操作系统中就分别对应两个进程。

### （3）异步：进程以不可预知的速度向前推进。

（异步性保证了系统的灵活性和高效利用资源，但也带来了**同步、互斥**等管理问题，需要操作系统进行协调。）

**举一个例子**：比如你在电脑上同时打开了音乐播放器和浏览器：音乐播放器在播放音乐时，浏览器可能在加载网页。

这两个进程的运行速度和进度互不影响，谁先执行、谁后执行，完全由操作系统调度和资源分配决定，用户无法预知。

### （4）虚拟：把物理上的实体变为逻辑上的对应物

**解释**：在操作系统中，指的是通过某种技术手段，把实际存在的物理资源（如内存、CPU、磁盘等）变成用户或程序“看到”的逻辑资源，使得用户感觉拥有独立、完整的资源。

物理资源是有限的，比如一台电脑只有一个CPU、有限的内存和磁盘。

操作系统通过“虚拟化”技术，把这些有限的物理资源“分割”或“扩展”，让每个进程或用户都感觉自己独占资源。

这样做的好处是提高了资源利用率，增强了系统的灵活性和安全性。

---
### 问：操作系统的主要特征包括哪几个，哪两个是基本的？


### 答：同步、共享、异步、虚拟； 同步和共享

---
### 3.操作系统的"功能"有哪些？

### （1）处理机管理
进程控制、进程同步、进程通信、死锁处理、处理机调度...

### （2）存储器管理
内存分配、地址映射、内存保护与共享、内存扩充...

### （3）文件管理
文件存储空间的管理、目录管理、文件读写管理和保护...

### （4）设备管理


### （5）用户接口
---
### 问：操作系统的主要功能包括哪几个？（填空或许会帮你些用户接口）


### 答：处理机管理、存储器管路、文件管理、设备管理、用户接口

---
### 4.操作系统的历程

### （1）手工操作阶段
人机速度矛盾

### （2）单道批处理阶段
**优点**：缓解人机速度矛盾

**缺点**：系统资源利用率很低

### （3）多道批处理阶段
**优点**：多道程序并发执行，资源利用率很高

**缺点**：不提供人机交互能力（缺少**交!互!性!**）

任务放入机器后不能更改，必须等到所有任务处理完成后才能更改

### （4）分时操作系统
**优点**：提供人机交互（交互性）

**缺点**：不能优先处理紧急事务


### （5）实时操作系统
硬实时系统：必须控制对象规定时间内完成（火箭发射）
软实时系统：松一点（订票）

都是要及时完成的，如果你取钱存钱不是实时的话，那么后果就有点糟糕了

**优点**：能优先处理紧急任务，从**可靠性**来看**实时操作系统**更强，从**交互性**看**分时系统**更强


---
### 5.基本概念


### （1）特权指令：不允许用户程序使用（只允许操作系统使用，如：IO指令、中断指令）
只有操作系统内核（内核态）才能执行

### （2）非特权指令：普通的运算指令（如：加法、减法、数据赋值、普通内存读写等。）
普通程序可以直接执行的安全指令，不会影响系统核心资源

### （3）内核程序：系统的管理者，可执行一切指令，运行在核心态

内核程序是操作系统的“心脏”，直接与硬件打交道，管理CPU、内存、设备、文件系统等资源。

只有内核程序才能执行特权指令，比如控制中断、访问I/O设备、管理内存等。

### （4）应用程序：普通用户只能执行非特权指令，运行在用户态（如：微信、QQ、浏览器、Word）

- **应用程序 = 住户**：只能在自己房间活动，权限有限，不能直接操作大楼的核心设施。
- **内核程序 = 物业**：管理整个大楼，拥有最高权限，可以直接操作所有核心设施，保障大楼安全和正常运行。


| 对比项 | 应用程序 | 内核程序（操作系统内核） |
| -------------- | ------------------------------------------ | --------------------------------------- |
| 定义 | 用户为完成特定任务而编写和运行的软件 | 操作系统中最核心、直接管理硬件的部分 |
| 运行权限 | 运行在用户态，权限受限 | 运行在内核态，拥有最高权限 |
| 能否直接操作硬件 | 不能，必须通过操作系统提供的接口间接访问 | 可以直接操作硬件 |
| 能否执行特权指令 | 不能，只能执行非特权指令 | 可以执行所有指令，包括特权指令 |
| 主要作用 | 实现用户需求，如聊天、浏览网页、写文档等 | 管理和分配系统资源，保障系统安全与稳定 |
| 例子 | 微信、QQ、Word、浏览器、游戏等 | Windows内核（ntoskrnl.exe）、Linux内核 |
| 是否常驻内存 | 不是，运行时才加载，关闭后释放 | 是，系统运行期间一直驻留在内存 |

我愿意把**应用程序和内核程序**都理解成软件，因为操作系统是软件，所以操作系统内核也是软件的一部分，应用程序也毋庸置疑是软件，所以直接理解成一个比较强能把手伸到硬件，一个比较弱，权限有限。

| 对比项           | 非特权指令                         | 特权指令                                   |
| ---------------- | ---------------------------------- | ------------------------------------------ |
| 定义             | 普通程序（用户态）也能执行的指令   | 只有操作系统内核（内核态）才能执行的指令   |
| 执行权限         | 用户态和内核态都可以执行           | 仅限内核态，用户程序执行会被禁止           |
| 作用范围         | 仅限于数据处理、普通运算等         | 直接操作硬件、管理系统资源                 |
| 典型功能         | 算术运算、数据传送、普通跳转等     | 控制中断、I/O操作、内存管理、进程调度等     |
| 安全性           | 不会影响系统安全                   | 涉及系统安全和稳定，误用会导致系统崩溃     |
| 例子             | 加法、减法、数据赋值、普通内存读写 | 设置/清除中断、启动I/O、修改页表等         |
| 用户程序能否执行 | 可以直接执行                       | 不能，执行会被系统阻止                     |

非特权指令和特权指令都是**硬件层面，cpu权限（处理器特权级）**

cpu权限分为内核态和用户态

--


root和非root用户是**操作系统层面，用户权限**

root用户权限再高，也只能在“用户态”下运行应用程序

*这部分我有点赘述了，但是我理解一个知识点需要很多铺垫，请见谅！*

---
### 6.处理机状态

这个就是上面说的
### 用户态：只能执行非特权指令

### 核心态：可以执行所有指令

用户态-->核心态：**中断（通过 硬件 完成）**

核心态-->用户态：**psw**

---
### 7.原语

后面的进程部分的pv操作会再次提到

（1）处在操作系统最底层，是最接近硬件的部分

（2）这些程序的运行具有原子性，其操作只能一气呵成

（3）这些程序的运行时间都很短，而且调用频繁

---
### 8.中断，系统调用，体系结构
### （1）内中断（异常，信号来自内部）

### （2）外中断（中断，信号来自内部）

### （3）系统调用
系统给程序员（应用程序）提供唯一的接口，可以获得os的服务，在用户态发生核心态处理

### （4）体系结构：大内核、微内核

---
用户态指令例子--->
访管指令：在用户态使用（用户态资自愿进入核心态）
---
